<!doctype html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sphoorthy Masa · UX Research Leader</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <style>
      :root{
        /* Core Palette */
        --bg: #f6f7fb;
        --bg-off: #ffffff;
        --ink: #0f172a;
        --ink-2: #334155;
        --muted: #64748b;
        --border-color: rgba(15, 23, 42, 0.08);

        /* Accents */
        --accent-1: #3b82f6;
        --accent-1-light: rgba(59, 130, 246, 0.1);
        --accent-1-glow: rgba(59, 130, 246, 0.5);
        --accent-2: #8b5cf6;
        --accent-2-light: rgba(139, 92, 246, 0.1);

        /* Futuristic System */
        --glass-bg: rgba(255, 255, 255, 0.85);
        --glass-border: rgba(255, 255, 255, 0.5);
        --glass-shadow: 0 8px 30px rgba(15, 23, 42, 0.1);

        --neon-shadow: 0 0 12px var(--accent-1-glow), 0 0 4px var(--accent-1-glow);

        /* Sizing */
        --radius-xl: 28px;
        --radius-lg: 22px;
        --radius-md: 16px;
        --radius-sm: 12px;
      }
      
      /* ===== Base & Reset ===== */
      *, *::before, *::after { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0;
        font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        color: var(--ink);
        background:
          radial-gradient(1200px 800px at 10% -10%, rgba(59, 130, 246, 0.12), transparent 60%),
          radial-gradient(1000px 700px at 90% -15%, rgba(139, 92, 246, 0.10), transparent 60%),
          linear-gradient(180deg, #ffffff 0%, #f8fafc 60%, #f6f7fb 100%);
        min-height: 100vh;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      
      /* Pointer Glow Effect */
      #pointer-glow {
        position: fixed;
        top: 0;
        left: 0;
        width: 600px;
        height: 600px;
        border-radius: 50%;
        background: radial-gradient(circle, rgba(59, 130, 246, 0.06) 0%, transparent 70%);
        pointer-events: none;
        transform: translate(-50%, -50%);
        z-index: 0;
        transition: transform 0.1s ease-out, opacity 0.3s ease;
        opacity: 0;
        will-change: transform;
      }
      body:hover #pointer-glow { opacity: 1; }

      .content-layer { position: relative; z-index: 1; padding-bottom: 4rem; }

      /* ===== Header (Plain) ===== */
      .site-header {
        position: sticky; top: 0; z-index: 50;
        display: flex; align-items: center; justify-content: space-between;
        padding: 0.9rem clamp(1rem, 3vw, 1.4rem);
        background: transparent;
        border-bottom: 1px solid var(--border-color);
        transition: background .25s ease, border-color .25s ease, box-shadow .25s ease;
      }
      .site-header.scrolled {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        box-shadow: 0 8px 30px rgba(15, 23, 42, 0.08);
      }
      .logo { font-size: 0.98rem; font-weight: 800; letter-spacing: 0.14em; text-transform: uppercase; color: var(--ink); }

      /* ===== NEW: Nav Menu (Dropdown) ===== */
      .nav-container { position: relative; }
      .menu-toggle {
        width: 42px; height: 42px; border-radius: 999px;
        border: 1px solid var(--border-color);
        background: rgba(255, 255, 255, 0.9);
        display: inline-flex; align-items: center; justify-content: center;
        cursor: pointer; transition: transform .2s ease, background .2s ease;
        color: var(--ink);
      }
      .menu-toggle:hover { transform: translateY(-1px); background: #fff; }
      .menu-toggle__line,
      .menu-toggle__line::before,
      .menu-toggle__line::after {
        content: ""; display: block; width: 18px; height: 2px; border-radius: 999px;
        background: currentColor; position: relative; transition: transform .25s ease, opacity .25s ease;
      }
      .menu-toggle__line::before { position: absolute; top: -6px; }
      .menu-toggle__line::after { position: absolute; top: 6px; }
      .menu-toggle[aria-expanded="true"] .menu-toggle__line { background: transparent; }
      .menu-toggle[aria-expanded="true"] .menu-toggle__line::before { transform: translateY(6px) rotate(45deg); }
      .menu-toggle[aria-expanded="true"] .menu-toggle__line::after { transform: translateY(-6px) rotate(-45deg); }

      .site-nav {
        position: absolute;
        top: calc(100% + 10px);
        right: 0;
        width: 220px;
        background: var(--bg-off);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        box-shadow: 0 10px 30px rgba(15, 23, 42, 0.12);
        padding: 0.5rem;
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
        z-index: 40;
        opacity: 0;
        transform: translateY(-10px);
        visibility: hidden;
        transition: opacity .2s ease, transform .2s ease, visibility .2s;
      }
      .site-nav[aria-hidden="false"] {
        opacity: 1;
        transform: translateY(0);
        visibility: visible;
      }
      .site-nav a {
        font-size: 0.95rem;
        font-weight: 600;
        color: var(--ink);
        text-decoration: none;
        padding: 0.6rem 0.8rem;
        border-radius: var(--radius-sm);
      }
      .site-nav a:hover, .site-nav a:focus-visible {
        background: var(--bg);
        color: var(--accent-1);
        outline: none;
      }
      /* Removed sidebar-specific styles */
      .menu-backdrop { display: none; } /* Not needed for dropdown */
      body.menu-open { overflow: visible; } /* Not needed for dropdown */


      .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }

      /* ===== Main Layout & Sections ===== */
      .site-main {
        width: min(1180px, 92vw); margin: 0 auto;
        padding: clamp(2.4rem, 6vw, 4.6rem) 0;
        display: flex; flex-direction: column;
        gap: clamp(3rem, 7vw, 5.5rem);
      }
      .section-eyebrow { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.24em; color: var(--accent-2); font-weight: 800; margin-bottom: 0.6rem; }
      .section-title { font-size: clamp(1.8rem, 1.4rem + 1.6vw, 2.4rem); margin: 0; }
      .section-lede { margin-top: 0.5rem; font-size: 1rem; color: var(--ink-2); max-width: 62ch; line-height: 1.7; }

      /* ===== Glass Card System ===== */
      .glass-card {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        box-shadow: var(--glass-shadow);
        border-radius: var(--radius-lg);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        position: relative;
        overflow: hidden;
      }
      /* Grain/Noise Effect */
      .glass-card::before {
        content: "";
        position: absolute;
        inset: 0;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 800 800' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='f'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23f)'/%3E%3C/svg%3E");
        opacity: 0.02;
        pointer-events: none;
        z-index: 0;
      }
      /* Ensure content is above grain */
      .glass-card > * { position: relative; z-index: 1; }

      /* ===== Hero ===== */
      .hero { display: grid; gap: clamp(1.8rem, 5vw, 3rem); grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); align-items: center; }
      .hero-eyebrow { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.26em; font-weight: 800; color: var(--accent-2); }
      .hero h1 { font-size: clamp(2.2rem, 2rem + 2vw, 3rem); line-height: 1.06; margin: 0.6rem 0 1rem; }
      .hero p { margin: 0; font-size: 1.02rem; color: var(--ink-2); line-height: 1.7; }
      .hero-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 0.9rem; margin-top: 1.4rem; }
      .hero-stat { background: var(--bg-off); border-radius: var(--radius-md); padding: 1rem 1.2rem; border: 1px solid var(--border-color); box-shadow: 0 4px 12px rgba(15, 23, 42, 0.05); }
      .hero-stat dt { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.12em; color: var(--muted); margin-bottom: 0.4rem; }
      .hero-stat dd { margin: 0; font-size: 1.28rem; font-weight: 800; color: var(--ink); }

      /* ===== Portfolio Layout ===== */
      .portfolio-layout {
        display: grid;
        gap: clamp(1.2rem, 3vw, 2rem);
        grid-template-columns: minmax(0, 0.95fr) minmax(0, 1.35fr);
        align-items: start;
        margin-top: clamp(1.2rem, 2vw, 2rem);
      }
      @media (max-width: 1024px) { .portfolio-layout { grid-template-columns: 1fr; } }

      /* Project Tiles (Left) */
      .project-tiles { display: flex; flex-direction: column; gap: 0.9rem; position: sticky; top: 80px; }
      @media (max-width: 1024px) { .project-tiles { position: relative; top: 0; } }
      .project-tile {
        border-radius: var(--radius-lg);
        border: 1px solid var(--border-color);
        background: var(--bg-off);
        padding: 1.2rem;
        display: flex; flex-direction: column; gap: 0.7rem;
        text-align: left; cursor: pointer;
        transition: transform .25s ease, box-shadow .3s ease, border-color .3s ease;
        will-change: transform, box-shadow;
      }
      .project-tile:hover, .project-tile:focus-visible {
        transform: translateY(-4px);
        border-color: rgba(15, 23, 42, 0.15);
        box-shadow: 0 8px 30px rgba(15, 23, 42, 0.08);
        outline: none;
      }
      .project-tile.active {
        border-color: var(--accent-1);
        box-shadow: var(--neon-shadow);
        background: #fff;
      }
      .project-tile h3 { margin: 0; font-size: 1.06rem; color: var(--ink); }
      .project-tile p { margin: 0; color: var(--ink-2); font-size: 0.94rem; line-height: 1.55; }
      .project-tile .project-outcome strong { color: var(--accent-2); margin-right: 0.35rem; }
      .project-tile figure {
        margin: 0.5rem 0 0; border-radius: var(--radius-md); overflow: hidden;
        border: 1px solid var(--border-color); aspect-ratio: 16/9; background: var(--bg);
        transition: transform .3s ease;
      }
      .project-tile:hover figure { transform: scale(1.03); }
      .project-tile img { width: 100%; height: 100%; object-fit: cover; display: block; }

      /* Project Detail (Right) - Glass Card */
      .project-detail {
        padding: clamp(1.4rem, 2.6vw, 2rem);
        border-radius: var(--radius-xl);
        display: flex; flex-direction: column; gap: 1.2rem;
        min-height: 100%;
      }
      .project-detail header h3 { margin: 0; font-size: clamp(1.5rem, 1.2rem + 1vw, 2rem); }
      .project-detail header p { margin: 0.2rem 0 0; color: var(--ink-2); }

      /* Tab Controls */
      .details-tabs { display: flex; flex-wrap: wrap; gap: 0.5rem; }
      .details-tabs button {
        padding: 0.5rem 1rem; border-radius: 999px;
        border: 1px solid var(--border-color);
        background: var(--bg-off); color: var(--ink-2);
        font-weight: 600; cursor: pointer;
        transition: background .2s ease, border-color .2s ease, color .2s ease;
      }
      .details-tabs button:hover, .details-tabs button:focus-visible {
        border-color: var(--accent-1);
        color: var(--accent-1);
      }
      .details-tabs button.active {
        background: var(--accent-1-light);
        border-color: var(--accent-1);
        color: var(--accent-1);
        font-weight: 700;
      }
      .details-tabs button:focus-visible {
        outline: 2px solid var(--accent-1);
        outline-offset: 2px;
      }

      /* Tab Panel Content */
      .tab-content { display: none; }
      .tab-content.active { display: block; animation: fadeIn .3s ease; }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: none; }
      }
      
      /* Base styles for transformed content */
      .detail-copy p, .detail-copy li { line-height: 1.65; color: var(--ink-2); }
      .detail-copy h4 { margin: 0.2rem 0 0.3rem; font-size: 1.02rem; color: var(--ink); }
      .detail-copy ul { margin: 0; padding-left: 1.1rem; display: grid; gap: 0.35rem; }

      /* ===== 1. Overview: Info Cards ===== */
      .infographic-grid {
        display: grid;
        gap: 0.8rem;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      }
      .info-card {
        background: var(--bg-off);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        padding: 1.2rem 1.1rem;
        display: flex; flex-direction: column; gap: 0.5rem;
      }
      .info-card h4 {
        margin: 0;
        font-size: 0.9rem;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .info-card .info-card-icon {
        width: 32px; height: 32px;
        border-radius: 999px;
        background-color: var(--accent-1-light);
        color: var(--accent-1);
        display: grid; place-items: center;
        font-weight: 700;
        font-size: 0.9rem;
        flex-shrink: 0;
      }
      .info-card p, .info-card ul {
        font-size: 0.9rem;
        color: var(--ink-2);
        line-height: 1.6;
      }
      .info-card ul { padding-left: 1.2rem; margin: 0; }

      /* ===== 2. Methodology: Timeline ===== */
      .process-timeline {
        list-style: none; padding: 0; margin: 0;
        display: grid; gap: 0.8rem;
      }
      .process-timeline li {
        background: var(--bg-off);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        padding: 1.1rem 1.2rem;
        display: flex;
        align-items: flex-start;
        gap: 0.8rem;
      }
      .process-timeline .timeline-icon {
        width: 36px; height: 36px;
        border-radius: 999px;
        background-color: var(--accent-2-light);
        color: var(--accent-2);
        display: grid; place-items: center;
        font-weight: 700;
        flex-shrink: 0;
        margin-top: 0.2rem;
      }
      .process-timeline .timeline-content h4 {
        margin: 0 0 0.3rem;
        font-size: 0.95rem;
        font-weight: 700;
      }
      .process-timeline .timeline-content p {
        margin: 0;
        font-size: 0.9rem;
        color: var(--ink-2);
      }
      .process-timeline .timeline-content p + p { margin-top: 0.5rem; }
      .process-timeline .timeline-content .tools {
        font-size: 0.8rem;
        font-weight: 600;
        color: var(--muted);
        margin-top: 0.6rem;
      }
      
      /* ===== 3. Analysis: Info Cards (re-using) ===== */
      /* .info-card styles from Overview are re-used here */
      .mini-viz-placeholder {
        height: 8px;
        width: 100%;
        background: linear-gradient(90deg, var(--accent-1-light) 0%, var(--accent-1) 30%, var(--accent-1) 50%, var(--accent-1-light) 100%);
        border-radius: 999px;
        margin-top: 0.75rem;
        opacity: 0.6;
      }

      /* ===== 4. Results: KPI Cards ===== */
      .kpi-grid {
        display: grid;
        gap: 0.8rem;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      }
      .kpi-card {
        background: var(--bg-off);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        padding: 1.2rem 1rem;
        text-align: center;
      }
      .kpi-card .kpi-icon {
        font-size: 1.5rem;
        line-height: 1;
        color: var(--accent-2);
        margin-bottom: 0.5rem;
      }
      .kpi-value-container {
        font-size: 1.75rem;
        font-weight: 800;
        color: var(--ink);
        line-height: 1.1;
      }
      .kpi-label {
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        color: var(--muted);
        margin-top: 0.4rem;
      }
      .results-summary {
        margin-top: 1.2rem;
        background: var(--bg-off);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        padding: 1.2rem;
      }
      .results-summary p, .results-summary ul { font-size: 0.95rem; }

      /* ===== 5. Media: JS Carousel ===== */
      .media-featured {
        border-radius: var(--radius-md);
        overflow: hidden;
        border: 1px solid var(--border-color);
        background: var(--bg);
        margin-bottom: 1rem;
        cursor: zoom-in;
      }
      .media-featured img { display: block; width: 100%; }
      .media-carousel-wrapper {
        position: relative;
        border-radius: var(--radius-md);
        border: 1px solid var(--border-color);
        background: var(--bg-off);
        overflow: hidden;
        padding: 0.75rem;
      }
      .media-carousel__viewport {
        overflow: hidden;
      }
      .media-carousel__track {
        display: flex;
        gap: 0.9rem;
        transition: transform .4s cubic-bezier(0.22, 1, 0.36, 1);
        will-change: transform;
      }
      .media-carousel__item {
        flex: 0 0 clamp(220px, 32vw, 340px);
        border-radius: var(--radius-sm);
        overflow: hidden;
        border: 1px solid var(--border-color);
        background: var(--bg);
        cursor: zoom-in;
        position: relative;
        opacity: 0.8;
        transition: opacity .25s ease;
      }
      @media (max-width: 600px) {
        .media-carousel__item {
          flex-basis: 80vw;
        }
      }
      .media-carousel__item:hover,
      .media-carousel__item:focus-visible {
        opacity: 1;
      }
      .media-carousel__item img {
        display: block; width: 100%; height: 100%; object-fit: cover;
      }
      
      /* Carousel Controls (Arrows) */
      .media-arrow {
        position: absolute; top: 50%; transform: translateY(-50%);
        width: 40px; height: 40px; border-radius: 999px;
        display: grid; place-items: center;
        background: rgba(255, 255, 255, 0.95);
        border: 1px solid var(--border-color);
        color: var(--ink);
        cursor: pointer; user-select: none;
        box-shadow: 0 4px 12px rgba(15, 23, 42, 0.1);
        transition: transform .2s ease, box-shadow .2s ease;
        z-index: 10;
      }
      .media-arrow:hover { transform: translateY(-50%) scale(1.05); }
      .media-arrow:disabled { opacity: 0.3; cursor: not-allowed; }
      .media-arrow--prev { left: 0.75rem; }
      .media-arrow--next { right: 0.75rem; }
      
      /* Carousel Controls (Dots) */
      .media-carousel__dots {
        position: absolute;
        bottom: 1.25rem;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 0.5rem;
        z-index: 10;
      }
      .media-dot {
        width: 8px; height: 8px;
        border-radius: 50%;
        background: rgba(15, 23, 42, 0.2);
        border: none;
        padding: 0;
        cursor: pointer;
        transition: background .2s ease;
      }
      .media-dot.active { background: var(--ink); }

      .media-caption {
        background: var(--bg-off);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        padding: 1rem 1.1rem;
        margin-top: 1rem;
      }
      .media-caption p { margin: 0; font-size: 0.9rem; line-height: 1.6; color: var(--ink-2); }
      
      /* ===== Lightbox ===== */
      .lightbox {
        position: fixed; inset: 0;
        background: rgba(246, 247, 251, 0.9);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        display: none;
        align-items: center; justify-content: center;
        z-index: 100;
        animation: fadeIn .3s ease;
      }
      .lightbox.open { display: flex; }
      .lightbox__inner {
        width: min(92vw, 1400px);
        height: min(88vh, 800px);
        display: flex; flex-direction: column; gap: 0.6rem;
      }
      .lightbox__stage {
        position: relative;
        border-radius: var(--radius-lg);
        overflow: hidden;
        border: 1px solid var(--border-color);
        background: #fff;
        flex-grow: 1;
        box-shadow: var(--glass-shadow);
      }
      .lightbox__img {
        position: absolute; inset: 0;
        width: 100%; height: 100%;
        object-fit: contain;
      }
      .lightbox__caption {
        text-align: center;
        color: var(--ink-2);
        font-weight: 500;
        font-size: 0.9rem;
      }
      .lightbox__controls {
        display: flex; align-items: center; gap: 0.6rem;
        justify-content: center;
      }
      .lightbox__btn {
        appearance: none;
        border: 1px solid var(--border-color);
        background: var(--bg-off);
        color: var(--ink);
        border-radius: 999px;
        padding: 0.55rem 1rem;
        cursor: pointer;
        font-weight: 600;
        transition: background .2s ease;
      }
      .lightbox__btn:hover { background: #eee; }
      .lightbox__btn:disabled { opacity: 0.4; cursor: not-allowed; }

      /* ===== Skills ===== */
      .skills-grid {
        display: grid; gap: 0.9rem;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        margin-top: 1.4rem;
      }
      .skill-card {
        padding: 1.2rem 1.4rem;
        background: var(--bg-off);
        border: 1px solid var(--border-color);
        box-shadow: 0 4px 12px rgba(15, 23, 42, 0.05);
        border-radius: var(--radius-md);
      }
      .skill-card h3 { margin: 0; }
      .skill-card p { margin: 0.3rem 0 0.7rem; color: var(--muted); line-height: 1.6; }
      .skill-card ul {
        margin: 0; padding: 0; list-style-type: none;
        display: flex; flex-wrap: wrap; gap: 0.5rem;
      }
      .chip {
        display: inline-flex; align-items: center; gap: 0.35rem;
        padding: 0.28rem 0.6rem; border-radius: 999px;
        border: 1px solid var(--border-color);
        background: var(--bg);
        font-weight: 600; font-size: 0.8rem; color: var(--ink);
      }

      /* ===== Testimonials ===== */
      .testimonial-wrapper { overflow: hidden; }
      #testimonial-track {
        position: relative;
        overflow: hidden;
        display: flex;
        width: fit-content;
        animation: testimonialMarquee 80s linear infinite;
        will-change: transform;
      }
      #testimonial-track:hover,
      #testimonial-track:focus-within {
        animation-play-state: paused;
      }
      @keyframes testimonialMarquee {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
      }
      .testimonial-row { display: flex; gap: 0.9rem; }
      .testimonial-card {
        min-width: clamp(280px, 36vw, 380px);
        padding: 1.1rem 1.3rem;
        background: var(--bg-off);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        box-shadow: 0 4px 12px rgba(15, 23, 42, 0.05);
      }
      .testimonial-author { font-weight: 800; margin-top: 0.4rem; color: var(--ink); }
      .testimonial-role { color: var(--muted); font-size: 0.9rem; }

      /* ===== Contact ===== */
      .contact-panel { padding: clamp(1.6rem, 3vw, 2.2rem); }
      .contact-grid {
        display: grid; gap: 0.8rem;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        margin-top: 1.5rem;
      }
      .contact-card {
        padding: 1rem 1.2rem;
        background: var(--bg-off);
        border: 1px solid var(--border-color);
        box-shadow: 0 4px 12px rgba(15, 23, 42, 0.05);
        border-radius: var(--radius-md);
        text-decoration: none;
        transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
      }
      .contact-card:hover, .contact-card:focus-visible {
        transform: translateY(-3px);
        border-color: var(--accent-1);
        box-shadow: var(--neon-shadow);
        outline: none;
      }
      .contact-card span { font-weight: 700; font-size: 1.05rem; color: var(--ink); }
      .contact-card p { margin: 0.2rem 0 0; color: var(--muted); font-size: 0.9rem; }

      /* ===== Footer ===== */
      .site-footer { text-align: center; padding: 2.6rem 1.2rem 2rem; color: var(--muted); font-size: 0.86rem; }

      /* ===== Utilities ===== */
      .reveal { opacity: 0; transform: translateY(24px); transition: opacity .6s ease, transform .6s ease; }
      .reveal.is-visible { opacity: 1; transform: none; }

      /* Accessibility */
      @media (prefers-reduced-motion: reduce) {
        *, *::before, *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
          scroll-behavior: auto !important;
        }
        #pointer-glow { display: none !important; }
        #testimonial-track {
          animation: none;
          display: block;
        }
        #testimonial-track .testimonial-row:last-child {
          display: none; /* Hide the duplicated row */
        }
        .kpi-value { animation: none !important; }
      }
    </style>
  </head>
  <body class="antialiased">
    <div id="pointer-glow" aria-hidden="true"></div>

    <div class="content-layer">
      <header class="site-header" id="site-header">
        <div class="logo">Sphoorthy Masa</div>
        
        <div class="nav-container">
          <button class="menu-toggle" type="button" data-menu-toggle aria-expanded="false" aria-controls="primary-nav">
            <span class="sr-only">Toggle navigation</span>
            <span class="menu-toggle__line" aria-hidden="true"></span>
          </button>
          <nav id="primary-nav" class="site-nav" aria-label="Primary navigation" data-menu-panel aria-hidden="true">
            <a href="#portfolio">Portfolio</a>
            <a href="#skills">Skills</a>
            <a href="#contact">Contact</a>
          </nav>
        </div>
        
      </header>

      <main class="site-main">
        <section id="intro" class="hero reveal">
          <div>
            <p class="hero-eyebrow">Purpose-built research for meaningful experiences</p>
            <h1>Senior UX Researcher</h1>
            <p>Bringing clarity to complexity through user-centric insights that drive product strategy and business growth.</p>
            <div class="hero-stats">
              <dl class="hero-stat"><dt>Programs led</dt><dd>60+</dd></dl>
              <dl class="hero-stat"><dt>Value impact</dt><dd>$25M+</dd></dl>
              <dl class="hero-stat"><dt>Hybrid teams</dt><dd>15</dd></dl>
            </div>
          </div>
          <div class="hero-visual">
            <div class="hero-visual__frame" style="position:relative;width:min(360px,80vw);aspect-ratio:3/4;border-radius:28px;overflow:hidden;border:1px solid var(--border-color);background:#fff;box-shadow: 0 20px 60px rgba(15,23,42,.12);isolation:isolate;">
              <img src="https://images.unsplash.com/photo-1521572267360-ee0c2909d518?auto=format&fit=crop&w=900&q=80" alt="Sphoorthy collaborating with a product team" loading="lazy" style="width:100%;height:100%;object-fit:cover;" />
            </div>
          </div>
        </section>

        <section id="portfolio" class="reveal">
          <div>
            <p class="section-eyebrow">Selected engagements</p>
            <h2 class="section-title">Research that accelerates bold product moves.</h2>
            <p class="section-lede">Explore how integrated qualitative and quantitative programs unlock clear direction, measurable value, and confident hand-offs to product delivery.</p>
          </div>

          <div class="portfolio-layout">
            <div id="project-tiles" class="project-tiles" aria-label="Project list"></div>
            <div id="project-detail" class="project-detail panel glass-card" aria-live="polite">
              </div>
          </div>
        </section>

        <section id="skills" class="skills-section reveal">
          <div class="skills-header">
            <p class="section-eyebrow">Skills &amp; Expertise</p>
            <h2 class="section-title">Research systems that scale</h2>
            <p class="section-lede">A curated mix of qualitative rigor, quantitative fluency, and facilitation craft to move teams from alignment to action.</p>
          </div>
          <div class="skills-grid">
            <article class="skill-card">
              <h3>Research Methodologies</h3>
              <p>Mixed-method programs spanning discovery, evaluative, and longitudinal studies.</p>
              <ul>
                <li class="chip">User interviews &amp; contextual inquiry</li>
                <li class="chip">Diary studies &amp; remote ethnography</li>
                <li class="chip">Quantitative surveys &amp; segmentation</li>
                <li class="chip">Usability testing &amp; rapid validation</li>
              </ul>
            </article>
            <article class="skill-card">
              <h3>Tools &amp; Platforms</h3>
              <p>Flexible ops + insight stack to partner with product, design, and data.</p>
              <ul>
                <li class="chip">UserZoom, UserTesting, Lookback</li>
                <li class="chip">Qualtrics, SurveyMonkey, Airtable</li>
                <li class="chip">Figma, FigJam, Miro, Dovetail</li>
                <li class="chip">Amplitude, GA, Quantum Metric</li>
              </ul>
            </article>
            <article class="skill-card">
              <h3>Strategic Enablement</h3>
              <p>Translating insight into direction with measurable outcomes.</p>
              <ul>
                <li class="chip">Vision framing &amp; opportunity mapping</li>
                <li class="chip">Experiment design &amp; KPI modeling</li>
                <li class="chip">Service blueprinting &amp; journeys</li>
                <li class="chip">Executive storytelling &amp; workshops</li>
              </ul>
            </article>
          </div>
        </section>

        <section id="testimonials" class="testimonial-wrapper reveal">
          <div>
            <p class="section-eyebrow">Voices from collaborators</p>
            <h2 class="section-title">Trusted by product, design, and executive teams.</h2>
          </div>
          <div id="testimonial-track" class="testimonial-track" aria-live="polite"></div>
        </section>

        <section id="contact" class="contact-section reveal">
          <div class="contact-panel glass-card">
            <p class="section-eyebrow">Let&rsquo;s build together</p>
            <h2 class="section-title">Bring research into the spotlight</h2>
            <p class="section-lede">If you&rsquo;re assembling a team where research shapes strategy, let&rsquo;s connect.</p>
            <div class="contact-grid">
              <a class="contact-card" href="#contact" aria-label="Resume placeholder">
                <span>Resume</span>
                <p>Download the latest case-study reel and CV.</p>
              </a>
              <a class="contact-card" href="mailto:sphoorthy.masa@example.com" aria-label="Email Sphoorthy">
                <span>Email</span>
                <p>Start a conversation about your research roadmap.</p>
              </a>
              <a class="contact-card" href="https://www.linkedin.com" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn placeholder">
                <span>LinkedIn</span>
                <p>Connect for thought leadership and speaking engagements.</p>
              </a>
            </div>
          </div>
        </section>
      </main>

      <footer class="site-footer">
        &copy; <span id="copyright-year">2024</span> Sphoorthy Masa. Crafted with glass & clarity.
      </footer>
    </div>

    <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="lightbox__inner">
        <div class="lightbox__stage">
          <img class="lightbox__img" alt="" src="" />
        </div>
        <div class="lightbox__caption" id="lightbox-caption"></div>
        <div class="lightbox__controls">
          <button class="lightbox__btn" data-lightbox-prev aria-label="Previous image">&larr; Prev</button>
          <button class="lightbox__btn" data-lightbox-close aria-label="Close lightbox">Close</button>
          <button class="lightbox__btn" data-lightbox-next aria-label="Next image">Next &rarr;</button>
        </div>
      </div>
    </div>

    <script>
      (() => {
        // --- Data Definitions ---

        const repoBase = (() => {
          const { pathname } = window.location;
          if (!pathname || pathname === "/") return "/";
          if (pathname.endsWith("/")) return pathname;
          const lastSlash = pathname.lastIndexOf("/");
          return lastSlash >= 0 ? pathname.slice(0, lastSlash + 1) : "/";
        })();

        const projects = [
          {
            id: "guide",
            title: "Reinventing the TV Guide",
            summary:
              "Unified Sling TV and DISH discovery into one adaptive experience using multi-surface research.",
            background:
              "A strategic research initiative to unify Sling TV and DISH TV guide experiences and turn friction into engagement.",
            outcome: "~$7.46M estimated annual impact",
            tileImage: "public/images/guide/guide-03.png",
            tileImageAlt: "Unified TV guide concept across multiple devices",
            content: {
              metrics: [
                { value: "~$7.46M", label: "Estimated annual value impact" },
                { value: "90%", label: "Target task success rate" },
                { value: "-12%", label: "CX complaints" },
              ],
              overview: `
                <div class="detail-copy">
                  <div>
                    <h4>Background</h4>
                    <p>The guide sits at the heart of content discovery but had evolved in parallel across Sling TV and DISH TV, creating fragmented experiences.</p>
                  </div>
                  <div>
                    <h4>The challenge</h4>
                    <p>Unify the guide experience to enhance usability and personalization without alienating loyal users on two very different platforms.</p>
                  </div>
                  <div>
                    <h4>Objectives</h4>
                    <ul>
                      <li>Identify user frustrations and unmet needs across platforms.</li>
                      <li>Uncover shared pain points to guide a unified design strategy.</li>
                      <li>Deliver actionable recommendations that balance user and business goals.</li>
                    </ul>
                  </div>
                </div>
              `,
              methodology: `
                <div class="detail-copy">
                  <div>
                    <h4>Discovery &amp; planning</h4>
                    <p>Partnered with product and ops leads to frame the opportunity, synthesize data, and establish decision criteria.</p>
                    <p><strong>Tools:</strong> UserZoom, Google Analytics, JIRA</p>
                  </div>
                  <div>
                    <h4>Generative research</h4>
                    <p>In-depth interviews revealed how households navigate content, why favorites lists stall, and what trust signals are missing.</p>
                    <p><strong>Tools:</strong> Lookback, remote moderated sessions</p>
                  </div>
                  <div>
                    <h4>Synthesis &amp; ideation</h4>
                    <p>Mapped journeys and service blueprints to expose systemic friction, co-creating with design and engineering.</p>
                    <p><strong>Tools:</strong> FigJam, Figma</p>
                  </div>
                  <div>
                    <h4>Validation &amp; delivery</h4>
                    <p>Iterative usability testing and launch playbooks ensured accessibility and operational readiness.</p>
                    <p><strong>Tools:</strong> UserTesting, Confluence</p>
                  </div>
                </div>
              `,
              analysis: `
                <div class="detail-copy">
                  <div>
                    <h4>Audience segments</h4>
                    <p><strong>DISH subscribers:</strong> rely on legacy navigation, need clarity and accessibility. <strong>Sling subscribers:</strong> expect speed, personalization, and cross-device parity.</p>
                  </div>
                  <div>
                    <h4>Quantitative signals</h4>
                    <ul>
                      <li>High engagement but lower playback (79% engagement → 56% playback on Sling).</li>
                      <li>Personalization features were underutilized despite clear retention gains.</li>
                      <li>44% of Sling guide sessions ended within 20 seconds without playback.</li>
                      <li>Navigation habits masked faster, time-based browsing patterns.</li>
                    </ul>
                  </div>
                </div>
              `,
              results: `
                <div class="detail-copy">
                  <p>Evidence-backed recommendations delivered measurable value across retention, upsell, and ad revenue channels.</p>
                  <ul>
                    <li><strong>$5.83M</strong> projected from retention uplift.</li>
                    <li><strong>$1.94M</strong> from feature upsells tied to personalization.</li>
                    <li><strong>$193K</strong> in incremental ad revenue.</li>
                    <li><strong>$63K</strong> in operational savings through workflow clarity.</li>
                  </ul>
                </div>
              `,
              media: {
                featured: {
                  src: "public/images/guide/guide-05.png",
                  alt: "Channel grid concept with tuned information density",
                },
                /* FIX: Manually adding all 16 images from your screenshot.
                  The original 4 are now mixed with the other 12.
                */
                carousel: [
                  { src: "public/images/guide/guide-07.png", alt: "Transition storyboard" },
                  { src: "public/images/guide/gr-01.png", alt: "Discovery synthesis mural" },
                  { src: "public/images/guide/gr-02.png", alt: "Persona snapshots" },
                  { src: "public/images/guide/gr-03.png", alt: "Service blueprint" },
                  { src: "public/images/guide/gr-04.png", alt: "Additional research" },
                  { src: "public/images/guide/gr-05.png", alt: "Additional research" },
                  { src: "public/images/guide/gr-06.png", alt: "Additional research" },
                  { src: "public/images/guide/guide-01.png", alt: "Guide concept 1" },
                  { src: "public/images/guide/guide-02.png", alt: "Guide concept 2" },
                  { src: "public/images/guide/guide-04.png", alt: "Guide concept 4" },
                  { src: "public/images/guide/guide-06.png", alt: "Guide concept 6" },
                  { src: "public/images/guide/guide-08.png", alt: "Guide concept 8" },
                  { src: "public/images/guide/guide-09.png", alt: "Guide concept 9" },
                  { src: "public/images/guide/guide-10.png", alt: "Guide concept 10" },
                ],
                caption: "Key visuals, flows, and prototypes that shaped the unified guide vision.",
              },
            },
          },
          {
            id: "gundersen",
            title: "Gundersen Health Virtual Care OS",
            summary:
              "Reimagined intake and triage flows for clinicians and patients inside a unified virtual care operating system.",
            background:
              "Streamlining prescription refills by empowering patients and reducing manual work for pharmacy staff.",
            outcome: "12,334+ active app users within 6 months",
            heroImage:
              "https://images.unsplash.com/photo-1580281658629-26036f899014?auto=format&fit=crop&w=1600&q=80",
            heroAlt: "Clinician reviewing a virtual care dashboard",
            content: {
              metrics: [
                { value: "12,334+", label: "Active app users" },
                { value: "36%", label: "Refill volume via app" },
                { value: "$702K+", label: "Annual labor savings" },
              ],
              overview: `
                <div class="detail-copy">
                  <div>
                    <h4>Background</h4>
                    <p>The mobile refill app aimed to reduce repetitive pharmacy work and enable patients to manage medications independently.</p>
                  </div>
                  <div>
                    <h4>Research goals</h4>
                    <ul>
                      <li>Drive awareness and adoption across clinics.</li>
                      <li>Shift 25% of monthly refills into the app experience.</li>
                      <li>Automate refill reminders and status updates at scale.</li>
                      <li>Reduce inbound call volume and manual outreach.</li>
                    </ul>
                  </div>
                </div>
              `,
              methodology: `
                <div class="detail-copy">
                  <div>
                    <h4>Workflow &amp; stakeholder analysis</h4>
                    <p>Shadowed pharmacists, RNs, and MAs to map the manual refill process and quantify hidden labor costs.</p>
                  </div>
                  <div>
                    <h4>Usability &amp; heuristic evaluation</h4>
                    <p>Evaluated the existing app with patients and staff to surface friction, accessibility gaps, and trust barriers.</p>
                  </div>
                  <div>
                    <h4>Discovery synthesis</h4>
                    <p>Reframed the problem around awareness and education, pairing messaging experiments with product refinements.</p>
                  </div>
                </div>
              `,
              analysis: `
                <div class="detail-copy">
                  <ul>
                    <li><strong>Minimalist UI delivered 95% task success</strong> but lacked emotional engagement.</li>
                    <li><strong>Awareness, not usability, blocked adoption</strong>—most patients didn’t know the app existed.</li>
                    <li><strong>Clinicians sought automation</strong> to reduce outbound calls and status updates.</li>
                  </ul>
                </div>
              `,
              results: `
                <div class="detail-copy">
                  <p>Marketing pilots plus in-clinic coaching exceeded every launch metric within six months.</p>
                  <ul>
                    <li><strong>12,334</strong> active users vs. the 10,000 target.</li>
                    <li><strong>16,476</strong> monthly refills vs. the 11,250 goal.</li>
                    <li><strong>$702K+</strong> in recovered labor time by reducing manual calls.</li>
                  </ul>
                </div>
              `,
              media: {
                featured: {
                  src: "https://images.unsplash.com/photo-1587614382346-4ec892f9aca3?auto=format&fit=crop&w=1600&q=80",
                  alt: "Telehealth dashboard interface concept",
                },
                carousel: [
                  {
                    src: "https://images.unsplash.com/photo-1580894894513-d75ec1c5c5a1?auto=format&fit=crop&w=1600&q=80",
                    alt: "Patient testing the simplified refill journey",
                  },
                  {
                    src: "https://images.unsplash.com/photo-1581090700227-1e37b190418e?auto=format&fit=crop&w=1600&q=80",
                    alt: "Co-creation workshop with clinical stakeholders",
                  },
                ],
                caption: "Pilot campaigns, usability labs, and co-creation sessions that drove adoption.",
              },
            },
          },
          {
            id: "live-rooms",
            title: "Validating Live Rooms",
            summary:
              "Launched a co-watching and commerce layer that extends live broadcasts into interactive communities.",
            background:
              "Validating a social TV concept by understanding how people want to engage during live content.",
            outcome: "Guided go/no-go decision",
            heroImage:
              "https://images.unsplash.com/photo-1511512578047-dfb367046420?auto=format&fit=crop&w=1600&q=80",
            heroAlt: "Friends enjoying an illuminated streaming session",
            content: {
              metrics: [
                { value: "87%", label: "Liked interactive features" },
                { value: "76%", label: "Preferred second-screen" },
                { value: "56%", label: "Engaged with emoji reactions" },
                { value: "41%", label: "Enjoyed live quizzes" },
              ],
              overview: `
                <div class="detail-copy">
                  <div>
                    <h4>Background</h4>
                    <p>Live Rooms explored how social chat, reactions, and interactive moments could elevate live TV viewing across genres.</p>
                  </div>
                  <div>
                    <h4>Research goals</h4>
                    <ul>
                      <li>Gauge desirability of interactive layers across sports and entertainment.</li>
                      <li>Understand how social features impact attention and enjoyment.</li>
                      <li>Ensure experimentation doesn’t disrupt core viewing.</li>
                    </ul>
                  </div>
                </div>
              `,
              methodology: `
                <div class="detail-copy">
                  <div>
                    <h4>Concept tests</h4>
                    <p>Eight in-depth sessions balanced experienced streamers and newcomers to probe baseline expectations.</p>
                  </div>
                  <div>
                    <h4>Live pilots</h4>
                    <p>Ran NBA and reality TV watch parties with 100+ participants, capturing telemetry and survey feedback.</p>
                  </div>
                  <div>
                    <h4>Signal instrumentation</h4>
                    <p>Tracked engagement loops, moderation needs, and conversion moments to inform roadmap bets.</p>
                  </div>
                </div>
              `,
              analysis: `
                <div class="detail-copy">
                  <ul>
                    <li><strong>Control is essential:</strong> 87% wanted the ability to toggle chat and reactions.</li>
                    <li><strong>Second-screen behavior:</strong> 76% preferred interacting on mobile while watching on TV.</li>
                    <li><strong>Feature fit varies by genre:</strong> Sports fans embraced fast chat; reality TV fans favored polls and quizzes.</li>
                  </ul>
                </div>
              `,
              results: `
                <div class="detail-copy">
                  <p>Engagement lifts across pilots informed a confident recommendation to proceed with phased investment.</p>
                  <ul>
                    <li><strong>3.1 hrs</strong> average viewing time during Jersey Shore Family Vacation pilots.</li>
                    <li><strong>94%</strong> feature adoption during BET Awards experiments.</li>
                    <li><strong>18%</strong> lift in session length across all cohorts.</li>
                  </ul>
                </div>
              `,
              media: {
                featured: {
                  src: "https://images.unsplash.com/photo-1525182008055-f88b95ff7980?auto=format&fit=crop&w=1600&q=80",
                  alt: "Prototype testing synchronized playback and chat",
                },
                carousel: [
                  {
                    src: "https://images.unsplash.com/photo-1525182008051-d4d6360c81e5?auto=format&fit=crop&w=1600&q=80",
                    alt: "Interactive live room interface exploration",
                  },
                  {
                    src: "https://images.unsplash.com/photo-1512427691650-1e0c0a1db8f1?auto-format&fit=crop&w=1600&q=80",
                    alt: "Researcher facilitating a live viewing workshop",
                  },
                ],
                caption: "Concept explorations, live pilots, and team workshops guiding the go/no-go decision.",
              },
            },
          },
        ];

        const testimonials = [
          {
            quote:
              "Sphoorthy translated fragmented data into a narrative the exec team rallied around. Her work sharpened our roadmap in under a quarter.",
            author: "Gary S.",
            role: "EVP & Group President, Video Services",
          },
          {
            quote:
              "Every engagement with Sphoorthy raised the bar for how we use research. Her insights were precise, fast, and always tied to business levers.",
            author: "AL Shanmugam",
            role: "Head of Product · AI, Personalization & Platform Growth",
          },
          {
            quote:
              "She created a research practice that designers and engineers trusted. Shipping high-impact work became significantly easier.",
            author: "Erik Jonathan Nava",
            role: "Lead Design System Designer · AXS",
          },
          {
            quote:
              "Sphoorthy has a gift for making insight storytelling magnetic. Our leadership team still references her frameworks months later.",
            author: "Emily K.",
            role: "Director of Product Management",
          },
          {
            quote:
              "Her strategic instinct is matched by rigor. We saw measurable retention and revenue gains because of her research programs.",
            author: "Anish Raul",
            role: "Generative AI & Personalisation Leader",
          },
          {
            quote:
              "Working with Sphoorthy is like adding a compass to your product team. She keeps momentum without sacrificing depth.",
            author: "Michael B.",
            role: "Senior Product Designer",
          },
        ];

        // --- Global State ---
        const state = {
          activeId: projects[0]?.id ?? null,
          activeCarousel: null,
          activeLightbox: null,
        };

        // --- Utility Functions ---

        function asset(path) {
          if (!path) return "";
          if (/^https?:/i.test(path)) return path;
          if (path.startsWith(repoBase)) return path;
          if (path.startsWith("/")) return path;
          const clean = path.replace(/^\/+/, "");
          return `${repoBase}${clean}`;
        }

        function escapeHtml(value) {
          return String(value ?? "")
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#39;");
        }

        function parseHtml(htmlString) {
          if (!htmlString) {
            console.warn("parseHtml received empty string.");
            htmlString = "<div></div>";
          }
          const template = document.createElement("template");
          template.innerHTML = htmlString.trim();
          return template.content;
        }

        // --- Visual Transformation Functions ---

        function renderOverview(htmlString) {
          const doc = parseHtml(htmlString);
          const sections = [];
          
          // Handle h4 + p (Background, Challenge)
          const h4s = doc.querySelectorAll("h4");
          h4s.forEach((h4, index) => {
            const nextEl = h4.nextElementSibling;
            if (nextEl && nextEl.tagName === 'P') {
              sections.push({
                icon: index === 0 ? "🎯" : "🔍",
                title: h4.textContent,
                content: `<p>${escapeHtml(nextEl.textContent)}</p>`,
              });
            }
            // Handle h4 + ul (Objectives, Research goals)
            else if (nextEl && nextEl.tagName === 'UL') {
              sections.push({
                icon: "📈",
                title: h4.textContent,
                content: nextEl.outerHTML,
              });
            }
          });

          // Fallback for Gundersen/Live Rooms (which don't have "Challenge")
          if (sections.length === 0) {
              const h4_1 = doc.querySelector("h4");
              const p_1 = doc.querySelector("p");
              const ul_1 = doc.querySelector("ul");
              if (h4_1 && p_1) {
                  sections.push({ icon: "🎯", title: h4_1.textContent, content: `<p>${escapeHtml(p_1.textContent)}</p>` });
              }
              if (ul_1) {
                  const h4_2 = doc.querySelectorAll("h4")[1] || { textContent: "Research goals" };
                  sections.push({ icon: "📈", title: h4_2.textContent, content: ul_1.outerHTML });
              }
          }

          return `
            <div class="infographic-grid">
              ${sections
                .map(
                  (s) => `
                <div class="info-card">
                  <h4><span class="info-card-icon">${s.icon}</span>${escapeHtml(s.title)}</h4>
                  ${s.content}
                </div>
              `
                )
                .join("")}
            </div>
          `;
        }

        function renderMethodology(htmlString) {
          const doc = parseHtml(htmlString);
          const steps = Array.from(doc.querySelectorAll(".detail-copy > div"));

          return `
            <ol class="process-timeline">
              ${steps
                .map((step, index) => {
                  const title = step.querySelector("h4")?.textContent || "";
                  const paragraphs = Array.from(step.querySelectorAll("p"))
                    .map((p) => {
                      if (p.querySelector("strong")) {
                        return `<p class="tools">${p.innerHTML}</p>`;
                      }
                      return `<p>${escapeHtml(p.textContent)}</p>`;
                    })
                    .join("");

                  return `
                  <li>
                    <span class="timeline-icon">${index + 1}</span>
                    <div class="timeline-content">
                      <h4>${escapeHtml(title)}</h4>
                      ${paragraphs}
                    </div>
                  </li>
                `;
                })
                .join("")}
            </ol>
          `;
        }

        function renderAnalysis(htmlString) {
          const doc = parseHtml(htmlString);
          const h4s = Array.from(doc.querySelectorAll("h4"));
          const uls = Array.from(doc.querySelectorAll("ul"));

          let content = "";
          if (h4s.length > 0) {
            content = h4s
              .map((h4, index) => {
                const ul = uls[index] || h4.nextElementSibling;
                return `
                <div class="info-card">
                  <h4>${escapeHtml(h4.textContent)}</h4>
                  ${ul?.outerHTML || ""}
                  <div class="mini-viz-placeholder"></div>
                </div>
              `;
              })
              .join("");
          } else if (uls.length > 0) {
            content = uls
              .map(
                (ul) => `
              <div class="info-card">
                ${ul.outerHTML}
                <div class="mini-viz-placeholder"></div>
              </div>
            `
              )
              .join("");
          }

          return `<div class="infographic-grid">${content}</div>`;
        }

        function renderResults(resultsString, metrics) {
          const doc = parseHtml(resultsString);
          const summary = doc.querySelector(".detail-copy")?.innerHTML || "";

          const kpiCards = (metrics || [])
            .map((metric) => {
              const value = metric.value || "0";
              const numericMatch = value.match(/[\d.,]+/);
              const number = numericMatch ? numericMatch[0].replace(/,/g, "") : "0";
              const prefix = value.substring(0, numericMatch?.index).trim();
              const suffix = value
                .substring((numericMatch?.index || 0) + number.length)
                .trim();
              
              const icon = (label) => {
                label = label.toLowerCase();
                if (label.includes("value") || label.includes("impact") || label.includes("savings")) return "💰";
                if (label.includes("rate") || label.includes("%") || label.includes("volume")) return "📈";
                if (label.includes("complaints")) return "📉";
                if (label.includes("users")) return "👥";
                return "✨";
              };

              return `
                <div class="kpi-card">
                  <div class="kpi-icon">${icon(metric.label)}</div>
                  <div class="kpi-value-container"
                       data-target="${escapeHtml(number)}"
                       data-prefix="${escapeHtml(prefix)}"
                       data-suffix="${escapeHtml(suffix)}">
                    <span class="kpi-prefix">${escapeHtml(prefix)}</span>
                    <span class="kpi-value">0</span>
                    <span class="kpi-suffix">${escapeHtml(suffix)}</span>
                  </div>
                  <div class="kpi-label">${escapeHtml(metric.label)}</div>
                </div>
              `;
            })
            .join("");

          return `
            ${kpiCards ? `<div class="kpi-grid">${kpiCards}</div>` : ""}
            ${summary ? `<div class="results-summary">${summary}</div>` : ""}
          `;
        }

        function renderMediaSection(media) {
          if (!media) {
            return `<div class="info-card"><p>Media assets coming soon.</p></div>`;
          }

          const allImages = [];
          if (media.featured) {
            allImages.push({ src: asset(media.featured.src), alt: media.featured.alt || "Featured image" });
          }
          if (media.carousel) {
            media.carousel.forEach(item => {
              allImages.push({ src: asset(item.src), alt: item.alt || "Project gallery" });
            });
          }

          const featured = media.featured
            ? `
              <div class="media-featured" data-lightbox-trigger="0">
                <img src="${asset(media.featured.src)}" alt="${escapeHtml(media.featured.alt || "Project media")}" loading="lazy" />
              </div>
            `
            : "";

          let carousel = "";
          if (Array.isArray(media.carousel) && media.carousel.length) {
            const items = media.carousel
              .map(
                (item, index) => `
                  <div class="media-carousel__item" data-lightbox-trigger="${index + (media.featured ? 1 : 0)}">
                    <img src="${asset(item.src)}" alt="${escapeHtml(item.alt || "Project gallery")}" loading="lazy" />
                  </div>
                `
              )
              .join("");

            carousel = `
              <div class="media-carousel-wrapper" id="media-carousel-instance">
                <button class="media-arrow media-arrow--prev" aria-label="Previous slide" disabled>&larr;</button>
                <div class="media-carousel__viewport">
                  <div class="media-carousel__track">${items}</div>
                </div>
                <button class="media-arrow media-arrow--next" aria-label="Next slide">&rarr;</button>
                <div class="media-carousel__dots"></div>
              </div>
            `;
          }

          const caption = media.caption
            ? `<div class="media-caption"><p>${escapeHtml(media.caption)}</p></div>`
            : "";

          const allImagesJson = escapeHtml(JSON.stringify(allImages));
          return `<div class="media-gallery-container" data-lightbox-images='${allImagesJson}'>${featured}${carousel}${caption}</div>`;
        }

        // --- Core Rendering Functions ---

        function renderProjectTiles() {
          const container = document.getElementById("project-tiles");
          if (!container || !projects.length) return;
          container.innerHTML = projects
            .map((project) => {
              const isActive = project.id === state.activeId;
              const imageSrc = asset(
                project.tileImage ||
                  project.heroImage ||
                  project.content?.media?.featured?.src ||
                  ""
              );
              const imageAlt = project.tileImageAlt || project.heroAlt || project.title;
              return `
                <button type="button" class="project-tile${isActive ? " active" : ""}" data-project-id="${project.id}">
                  <h3>${escapeHtml(project.title)}</h3>
                  <p>${escapeHtml(project.background)}</p>
                  <p class="project-outcome"><strong>Results</strong> ${escapeHtml(project.outcome)}</p>
                  ${imageSrc ? `<figure><img src="${imageSrc}" alt="${escapeHtml(imageAlt)}" loading="lazy" /></figure>` : ""}
                </button>
              `;
            })
            .join("");
        }

        function renderProjectDetail() {
          const container = document.getElementById("project-detail");
          if (!container) return;
          const project = projects.find((item) => item.id === state.activeId);
          if (!project) {
            container.innerHTML = "";
            return;
          }

          if (state.activeCarousel) {
            state.activeCarousel.destroy();
            state.activeCarousel = null;
          }
          if (state.activeLightbox) {
            state.activeLightbox.destroy();
            state.activeLightbox = null;
          }

          const sections = [
            { key: "overview", label: "Overview" },
            { key: "methodology", label: "Methodology" },
            { key: "analysis", label: "Analysis" },
            { key: "results", label: "Results" },
            { key: "media", label: "Media" },
          ].filter((section) => project.content?.[section.key]);

          const tabButtons = sections
            .map(
              (section, index) => `
                <button type="button" role="tab" aria-selected="${index === 0}" aria-controls="tab-panel-${section.key}" id="tab-btn-${section.key}" class="tab-btn${index === 0 ? " active" : ""}" data-tab="${section.key}">
                  ${section.label}
                </button>
              `
            )
            .join("");

          const tabPanels = sections
            .map((section, index) => {
              let html = "";
              switch (section.key) {
                case "overview":
                  html = renderOverview(project.content.overview);
                  break;
                case "methodology":
                  html = renderMethodology(project.content.methodology);
                  break;
                case "analysis":
                  html = renderAnalysis(project.content.analysis);
                  break;
                case "results":
                  html = renderResults(project.content.results, project.content.metrics);
                  break;
                case "media":
                  html = renderMediaSection(project.content.media);
                  break;
                default:
                  html = project.content[section.key] ?? "";
              }
              return `
                <div class="tab-content${index === 0 ? " active" : ""}" role="tabpanel" aria-labelledby="tab-btn-${section.key}" id="tab-panel-${section.key}" data-tab-panel="${section.key}">
                  ${html}
                </div>
              `;
            })
            .join("");

          container.innerHTML = `
            <header>
              <span class="section-eyebrow">Case study</span>
              <h3>${escapeHtml(project.title)}</h3>
              ${project.summary ? `<p>${escapeHtml(project.summary)}</p>` : ""}
            </header>
            <div class="details-tabs" role="tablist">${tabButtons}</div>
            <div class="tab-panels">${tabPanels}</div>
          `;

          initTabInteractions(container);
          initKpiAnimations(container);
          initMedia(container);
        }
        
        function renderTestimonials() {
          const container = document.getElementById("testimonial-track");
          if (!container || !testimonials.length) return;
          const row = document.createElement("div");
          row.className = "testimonial-row";
          row.innerHTML = testimonials.map(createTestimonialCard).join("");
          const clone = row.cloneNode(true);
          container.innerHTML = "";
          container.append(row, clone);
        }

        function createTestimonialCard(testimonial) {
          return `
            <article class="testimonial-card">
              <p>“${escapeHtml(testimonial.quote)}”</p>
              <div>
                <div class="testimonial-author">${escapeHtml(testimonial.author)}</div>
                <div class="testimonial-role">${escapeHtml(testimonial.role)}</div>
              </div>
            </article>
          `;
        }

        // --- Interactive Component Classes ---

        class Carousel {
          constructor(element) {
            this.element = element;
            this.track = element.querySelector(".media-carousel__track");
            this.items = Array.from(element.querySelectorAll(".media-carousel__item"));
            this.prevBtn = element.querySelector(".media-arrow--prev");
            this.nextBtn = element.querySelector(".media-arrow--next");
            this.dotsContainer = element.querySelector(".media-carousel__dots");
            
            if (!this.track || this.items.length === 0) return;

            this.currentIndex = 0;
            this.itemWidth = this.items[0].offsetWidth + parseFloat(getComputedStyle(this.track).gap);
            this.visibleItems = Math.floor(this.element.querySelector(".media-carousel__viewport").offsetWidth / this.itemWidth);
            this.maxIndex = this.items.length - this.visibleItems;
            if (this.maxIndex < 0) this.maxIndex = 0; // Handle case where items < visible
            this.dots = [];
            this.timer = null;
            this.resizeObserver = new ResizeObserver(this.onResize.bind(this));

            this.init();
          }

          init() {
            this.createDots();
            this.bindEvents();
            this.updateControls();
            this.startAutoPlay();
            this.resizeObserver.observe(this.element);
          }

          onResize() {
            this.itemWidth = this.items[0].offsetWidth + parseFloat(getComputedStyle(this.track).gap);
            this.visibleItems = Math.floor(this.element.querySelector(".media-carousel__viewport").offsetWidth / this.itemWidth);
            this.maxIndex = this.items.length - this.visibleItems;
            if (this.maxIndex < 0) this.maxIndex = 0;
            this.createDots();
            this.goTo(this.currentIndex); // Re-align
          }

          createDots() {
            if (!this.dotsContainer) return;
            this.dotsContainer.innerHTML = "";
            this.dots = [];
            for (let i = 0; i <= this.maxIndex; i++) {
              const button = document.createElement("button");
              button.className = "media-dot";
              button.setAttribute("aria-label", `Go to slide ${i + 1}`);
              button.addEventListener("click", () => this.goTo(i));
              this.dotsContainer.appendChild(button);
              this.dots.push(button);
            }
          }

          bindEvents() {
            this.prevBtn.addEventListener("click", this.prev.bind(this));
            this.nextBtn.addEventListener("click", this.next.bind(this));
            this.element.addEventListener("mouseenter", this.stopAutoPlay.bind(this));
            this.element.addEventListener("mouseleave", this.startAutoPlay.bind(this));
            this.element.addEventListener("focusin", this.stopAutoPlay.bind(this));
            this.element.addEventListener("focusout", this.startAutoPlay.bind(this));
          }

          goTo(index) {
            this.currentIndex = Math.max(0, Math.min(index, this.maxIndex));
            this.track.style.transform = `translateX(-${this.currentIndex * this.itemWidth}px)`;
            this.updateControls();
            this.resetAutoPlay();
          }

          next() {
            this.goTo(this.currentIndex + 1);
          }

          prev() {
            this.goTo(this.currentIndex - 1);
          }

          updateControls() {
            this.prevBtn.disabled = this.currentIndex === 0;
            this.nextBtn.disabled = this.currentIndex >= this.maxIndex;
            
            this.dots.forEach((dot, index) => {
              dot.classList.toggle("active", index === this.currentIndex);
            });
          }

          startAutoPlay() {
            if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
            this.stopAutoPlay();
            this.timer = setInterval(() => {
              const nextIndex = (this.currentIndex >= this.maxIndex) ? 0 : this.currentIndex + 1;
              this.goTo(nextIndex);
            }, 5000);
          }

          stopAutoPlay() {
            clearInterval(this.timer);
            this.timer = null;
          }
          
          resetAutoPlay() {
            this.stopAutoPlay();
            this.startAutoPlay();
          }

          destroy() {
            this.stopAutoPlay();
            this.resizeObserver.disconnect();
          }
        }

        class Lightbox {
          constructor(element, images) {
            this.lightboxElement = element;
            this.images = images;
            this.currentIndex = 0;
            
            this.img = this.lightboxElement.querySelector(".lightbox__img");
            this.caption = this.lightboxElement.querySelector("#lightbox-caption");
            this.prevBtn = this.lightboxElement.querySelector("[data-lightbox-prev]");
            this.nextBtn = this.lightboxElement.querySelector("[data-lightbox-next]");
            this.closeBtn = this.lightboxElement.querySelector("[data-lightbox-close]");

            this.boundHandleKeydown = this.handleKeydown.bind(this);
            this.bindEvents();
          }
          
          bindEvents() {
            this.closeBtn.addEventListener("click", this.close.bind(this));
            this.prevBtn.addEventListener("click", this.prev.bind(this));
            this.nextBtn.addEventListener("click", this.next.bind(this));
            this.lightboxElement.addEventListener("click", (e) => {
              if (e.target === this.lightboxElement) this.close();
            });
          }
          
          handleKeydown(e) {
            if (!this.isOpen()) return;
            if (e.key === "Escape") this.close();
            if (e.key === "ArrowLeft") this.prev();
            if (e.key === "ArrowRight") this.next();
          }

          open(index) {
            this.lightboxElement.classList.add("open");
            this.lightboxElement.setAttribute("aria-hidden", "false");
            document.body.style.overflow = "hidden";
            document.addEventListener("keydown", this.boundHandleKeydown);
            this.showImage(index);
          }
          
          close() {
            this.lightboxElement.classList.remove("open");
            this.lightboxElement.setAttribute("aria-hidden", "true");
            document.body.style.overflow = "";
            document.removeEventListener("keydown", this.boundHandleKeydown);
          }
          
          isOpen() {
            return this.lightboxElement.classList.contains("open");
          }

          showImage(index) {
            this.currentIndex = index;
            const { src, alt } = this.images[this.currentIndex];
            this.img.src = src;
            this.img.alt = alt;
            this.caption.textContent = alt;
            
            this.prevBtn.disabled = this.currentIndex === 0;
            this.nextBtn.disabled = this.currentIndex === this.images.length - 1;
          }
          
          prev() {
            if (this.currentIndex > 0) this.showImage(this.currentIndex - 1);
          }
          
          next() {
            if (this.currentIndex < this.images.length - 1) this.showImage(this.currentIndex + 1);
          }
          
          destroy() {
            document.removeEventListener("keydown", this.boundHandleKeydown);
          }
        }


        // --- Initialization & Event Binding ---

        function initMedia(container) {
          const carouselElement = container.querySelector("#media-carousel-instance");
          if (carouselElement) {
            // Wait for images to load to get correct widths
            Promise.all(Array.from(carouselElement.querySelectorAll('img')).map(img => {
              if (img.complete) return Promise.resolve();
              return new Promise(resolve => { img.onload = resolve; img.onerror = resolve; });
            })).then(() => {
              state.activeCarousel = new Carousel(carouselElement);
            });
          }
          
          const mediaContainer = container.querySelector(".media-gallery-container");
          const lightboxElement = document.getElementById("lightbox");
          if (mediaContainer && lightboxElement) {
            try {
              const images = JSON.parse(mediaContainer.dataset.lightboxImages);
              state.activeLightbox = new Lightbox(lightboxElement, images);
              
              container.querySelectorAll("[data-lightbox-trigger]").forEach(trigger => {
                trigger.addEventListener("click", () => {
                  const index = parseInt(trigger.dataset.lightboxTrigger, 10);
                  state.activeLightbox.open(index);
                });
              });
            } catch (e) {
              console.error("Failed to parse lightbox images:", e);
            }
          }
        }

        function initKpiAnimations(container) {
          const kpiCards = container.querySelectorAll(".kpi-value-container[data-target]");
          if (kpiCards.length === 0) return;

          const runAnimation = (card) => {
            const valueEl = card.querySelector(".kpi-value");
            const target = parseFloat(card.dataset.target);
            if (isNaN(target)) {
              valueEl.textContent = card.dataset.target; // Handle non-numeric like "90%"
              return;
            }
            if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
              valueEl.textContent = card.dataset.target;
              return;
            }
            animateCountUp(valueEl, target);
          };

          const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                const card = entry.target;
                runAnimation(card);
                observer.unobserve(card);
              }
            });
          }, { threshold: 0.8 });

          kpiCards.forEach(card => observer.observe(card));
        }

        function animateCountUp(el, target) {
          const duration = 1500;
          const frameDuration = 1000 / 60;
          const totalFrames = Math.round(duration / frameDuration);
          const increment = target / totalFrames;
          let current = 0;
          
          const decimals = (target.toString().split('.')[1] || '').length;

          const update = () => {
            current += increment;
            if (current >= target) {
              el.textContent = target.toLocaleString(undefined, { minimumFractionDigits: decimals, maximumFractionDigits: decimals });
            } else {
              el.textContent = current.toLocaleString(undefined, { minimumFractionDigits: decimals, maximumFractionDigits: decimals });
              requestAnimationFrame(update);
            }
          };
          requestAnimationFrame(update);
        }

        function initTabInteractions(container) {
          const tablist = container.querySelector(".details-tabs");
          if (!tablist) return;
          
          const tabs = Array.from(tablist.querySelectorAll(".tab-btn"));
          const panels = Array.from(container.querySelectorAll(".tab-content"));

          const setActive = (tab) => {
            tabs.forEach((button) => {
              const isActive = button.dataset.tab === tab.dataset.tab;
              button.classList.toggle("active", isActive);
              button.setAttribute("aria-selected", isActive);
            });
            panels.forEach((panel) => {
              const isActive = panel.dataset.tabPanel === tab.dataset.tab;
              panel.classList.toggle("active", isActive);
            });
          };

          tabs.forEach((tab) => {
            tab.addEventListener("click", (e) => setActive(e.currentTarget));
            tab.addEventListener("keydown", (e) => {
              if (e.key === "Enter" || e.key === " ") {
                e.preventDefault();
                setActive(e.currentTarget);
              }
            });
          });
        }

        function mountProjectInteractions() {
          const container = document.getElementById("project-tiles");
          if (!container) return;
          container.addEventListener("click", (event) => {
            const tile = event.target.closest(".project-tile");
            if (!tile) return;
            const projectId = tile.getAttribute("data-project-id");
            if (!projectId || projectId === state.activeId) return;
            state.activeId = projectId;
            renderProjectTiles();
            renderProjectDetail();
          });
        }

        function updateYear() {
          const year = document.getElementById("copyright-year");
          if (year) {
            year.textContent = new Date().getFullYear();
          }
        }

        /**
         * NEW: Dropdown Menu Logic
         */
        function setupMenuToggle() {
          const toggle = document.querySelector("[data-menu-toggle]");
          const panel = document.querySelector("[data-menu-panel]");
          if (!toggle || !panel) return;

          const openMenu = () => {
            panel.setAttribute("aria-hidden", "false");
            toggle.setAttribute("aria-expanded", "true");
            panel.querySelector("a")?.focus();
          };

          const closeMenu = () => {
            panel.setAttribute("aria-hidden", "true");
            toggle.setAttribute("aria-expanded", "false");
            toggle.focus();
          };
          
          const toggleMenu = () => {
            if (panel.getAttribute("aria-hidden") === "true") {
              openMenu();
            } else {
              closeMenu();
            }
          };

          toggle.addEventListener("click", toggleMenu);
          panel.addEventListener("click", (event) => {
            if (event.target.matches("a")) closeMenu();
          });

          // Close when clicking outside
          document.addEventListener("click", (event) => {
            if (!panel.contains(event.target) && !toggle.contains(event.target)) {
              if (panel.getAttribute("aria-hidden") === "false") {
                closeMenu();
              }
            }
          });

          // Close with Escape key
          document.addEventListener("keydown", (event) => {
            if (event.key === "Escape" && panel.getAttribute("aria-hidden") === "false") {
              closeMenu();
            }
          });
        }

        function setupPointerGlow() {
          const motionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
          if (motionQuery.matches) return;

          const glow = document.getElementById('pointer-glow');
          if (!glow) return;

          document.addEventListener('mousemove', (e) => {
            window.requestAnimationFrame(() => {
              glow.style.transform = `translate(${e.clientX}px, ${e.clientY}px)`;
            });
          }, { passive: true });
        }

        function attachRevealObserver() {
          const elements = document.querySelectorAll(".reveal");
          if (!elements.length) return;
          const observer = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  entry.target.classList.add("visible", "is-visible");
                  observer.unobserve(entry.target);
                }
              });
            },
            { threshold: 0.15 }
          );
          elements.forEach((el) => observer.observe(el));
        }
        
        // --- Main Initialization ---

        function init() {
          attachRevealObserver();
          renderProjectTiles();
          renderProjectDetail(); // This now kicks off all other project-specific JS
          mountProjectInteractions();
          renderTestimonials();
          updateYear();
          setupMenuToggle();
          setupPointerGlow();

          // Header scroll logic
          const header = document.getElementById('site-header');
          if (header) {
            const setScrolled = () => header.classList.toggle('scrolled', window.scrollY > 8);
            document.addEventListener('scroll', setScrolled, { passive:true }); setScrolled();
          }
        }

        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", init);
        } else {
          init();
        }
      })();
    </script>
  </body>
</html>
